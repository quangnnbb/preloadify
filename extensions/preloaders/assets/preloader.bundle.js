(function(){class P extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){this.render().then(()=>this._setup())}getAttr(n,d){const v=this.getAttribute(n);return v==null||v===""?d:v}hexToRgb(h){h=(h||"#000").replace('#','');return{r:parseInt(h.substr(0,2),16)||0,g:parseInt(h.substr(2,2),16)||0,b:parseInt(h.substr(4,2),16)||0}}async render(){const type=this.getAttr('data-css-loader','pulseOrbit');const bgHex=this.getAttr('data-background','#ffffff');const priHex=this.getAttr('data-primary','#000000');const secHex=this.getAttr('data-secondary','#ffffff');const assetBase=this.getAttr('data-asset-base','');const bg=this.hexToRgb(bgHex),p=this.hexToRgb(priHex),s=this.hexToRgb(secHex);try{const allow=["pulseOrbit","thinLionfish","jollyKangaroo","emberLoop","orbitDot","hypnoticLoop","dualOrbit","arcMotion","jumpingSquare","dualFrame","riseBlock","urbanDrive","tameFly","loadingBar"];const safe=allow.includes(type)?type:"pulseOrbit";const baseUrl=assetBase.replace('pulseOrbit.js',`${safe}.js`);const mod=await import(baseUrl);const cfg=mod?.[`${safe}Config`]||mod?.default;if(!cfg||!cfg.css||!cfg.html)throw new Error('Invalid loader');let css=cfg.css;const pColor=`rgb(${p.r}, ${p.g}, ${p.b})`,sColor=`rgb(${s.r}, ${s.g}, ${s.b})`;css=css.replace(/#000/g,pColor).replace(/#0070f3/g,pColor).replace(/#f3f3f3/g,sColor);const spd=this.getAttr('data-animation-speed','medium');const spdVal=spd==='slow'?'1.5s':spd==='fast'?'.5s':'1s';this.shadowRoot.innerHTML=`<style>:host{--r:${bg.r};--g:${bg.g};--b:${bg.b};--p-r:${p.r};--p-g:${p.g};--p-b:${p.b};--s-r:${s.r};--s-g:${s.g};--s-b:${s.b};--background:rgb(var(--r),var(--g),var(--b));--primary:rgb(var(--p-r),var(--p-g),var(--p-b));--secondary:rgb(var(--s-r),var(--s-g),var(--s-b));--speed:${spdVal};}${css}</style>${cfg.html}`;}catch(e){console.error('Failed to load loader:',type,e)}}_setup(){window.addEventListener('load',()=>this._hide());setTimeout(()=>this._hide(),3000);this._setupLinks()}_setupLinks(){if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>this._attachLinks())}else{this._attachLinks()}const obs=new MutationObserver(()=>this._attachLinks());obs.observe(document.body,{childList:true,subtree:true})}_attachLinks(){const links=document.querySelectorAll('a[href]');links.forEach(link=>{if(link.hasAttribute('data-preloader-attached'))return;link.setAttribute('data-preloader-attached','true');link.addEventListener('click',(e)=>{const href=link.getAttribute('href');if(!href||href==='#'||href.startsWith('#')||link.getAttribute('target')==='_blank'||link.hasAttribute('download')||href.startsWith('mailto:')||href.startsWith('tel:')||href.startsWith('javascript:')||link.closest('[data-no-preloader]')||e.metaKey||e.ctrlKey||e.shiftKey||e.button!==0)return;try{const linkUrl=new URL(href,window.location.origin);const currentUrl=new URL(window.location.href);if(linkUrl.origin!==currentUrl.origin)return;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null}const cs=window.getComputedStyle(this);const hidden=cs.opacity==='0'||cs.visibility==='hidden'||this.style.opacity==='0'||this.style.visibility==='hidden';if(hidden){this._show()}}catch(err){if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null}const cs=window.getComputedStyle(this);const hidden=cs.opacity==='0'||cs.visibility==='hidden'||this.style.opacity==='0'||this.style.visibility==='hidden';if(hidden){this._show()}}})})}_show(){this.style.transition='none';this.style.opacity='1';this.style.pointerEvents='auto';this.style.visibility='visible';setTimeout(()=>{this.style.transition=''},10)}_hide(){this._hideTimeout=setTimeout(()=>{this.style.opacity='0';this.style.pointerEvents='none';setTimeout(()=>{this.style.visibility='hidden'},500)},500)}}if(!customElements.get('sht-preloader')){customElements.define('sht-preloader',P)}})();

